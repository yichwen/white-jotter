webpackJsonp([6],{AZ1j:function(e,t){},cdRC:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticStyle:{"text-align":"left"}},[l("el-button",{staticClass:"add-button",attrs:{type:"success"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加角色")]),e._v(" "),l("el-dialog",{attrs:{title:"添加角色",visible:e.dialogFormVisible,width:"25%"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.clear}},[l("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{model:e.roleForm,rules:e.rules,"label-position":"left","label-width":"0px"}},[l("el-form-item",{attrs:{prop:"name"}},[l("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"角色名"},model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}})],1),e._v(" "),l("el-form-item",{attrs:{prop:"nameZh"}},[l("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"角色描述"},model:{value:e.roleForm.nameZh,callback:function(t){e.$set(e.roleForm,"nameZh",t)},expression:"roleForm.nameZh"}})],1),e._v(" "),l("el-form-item",{staticStyle:{width:"100%"}},[l("el-button",{staticStyle:{width:"40%",background:"#505458",border:"none"},attrs:{type:"primary"},on:{click:e.createRole}},[e._v("添加")])],1),e._v(" "),l("el-form-item",{attrs:{prop:"username"}},[l("el-tag",[e._v("初始权限：无")])],1)],1)],1)],1)},staticRenderFns:[]};var a=l("VU/8")({name:"RoleCreate",data:function(){return{dialogFormVisible:!1,rules:{name:[{required:!0,message:"角色名不能为空",trigger:"blur"}]},checked:!0,roleForm:{name:"",nameZh:""},loading:!1}},methods:{clear:function(){this.roleForm={name:"",nameZh:""}},createRole:function(){var e=this;this.$axios.post("/admin/role",{name:this.roleForm.name,nameZh:this.roleForm.nameZh}).then(function(t){200===t.data.code?(e.$alert("成功添加角色","提示",{confirmButtonText:"确定"}),e.clear(),e.$emit("onSubmit")):e.$alert("无法添加角色，请联络系统管理员","提示",{confirmButtonText:"确定"})}).catch(function(t){e.$alert("无法添加角色，请联络系统管理员","错误",{confirmButtonText:"确定"})}),this.dialogFormVisible=!1}}},o,!1,function(e){l("pevx")},"data-v-4d1b3c23",null);t.default=a.exports},pevx:function(e,t){},pmqU:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={name:"UserRole",components:{RoleCreate:l("cdRC").default},data:function(){return{dialogFormVisible:!1,roles:[],perms:[],menus:[],selectedRole:[],selectedPermsIds:[],selectedMenusIds:[],props:{id:"id",label:"nameZh",children:"children"}}},mounted:function(){this.listRoles(),this.listPerms(),this.listMenus()},computed:{tableHeight:function(){return window.innerHeight-320}},methods:{listRoles:function(){var e=this;this.$axios.get("/admin/role").then(function(t){t&&200===t.status&&(e.roles=t.data.result)})},listPerms:function(){var e=this;this.$axios.get("/admin/role/perm").then(function(t){t&&200===t.data.code&&(e.perms=t.data.result)})},listMenus:function(){var e=this;this.$axios.get("/admin/role/menu").then(function(t){t&&200===t.data.code&&(e.menus=t.data.result)})},commitStatusChange:function(e,t){var l=this;1!==t.id?this.$confirm("是否更改角色状态？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.$axios.put("/admin/role/status",{enabled:e,id:t.id}).then(function(o){o&&200===o.data.code&&(e?l.$message("角色 ["+t.nameZh+"] 已启用"):l.$message("角色 ["+t.nameZh+"] 已禁用"))})}).catch(function(){t.enabled=!t.enabled,l.$message({type:"info",message:"已取消"})}):(t.enabled=!0,this.$alert("无法禁用系统管理员！"))},editRole:function(e){this.dialogFormVisible=!0,this.selectedRole=e;for(var t=[],l=0;l<e.perms.length;l++)t.push(e.perms[l].id);this.selectedPermsIds=t;for(var o=[],a=0;a<e.menus.length;a++){o.push(e.menus[a].id);for(var n=0;n<e.menus[a].children.length;n++)o.push(e.menus[a].children[n].id)}this.selectedMenusIds=o,this.$refs.tree&&this.$refs.tree.setCheckedKeys(o)},onSubmit:function(e){var t=this;this.$axios.put("/admin/role",{id:e.id,name:e.name,nameZh:e.nameZh,enabled:e.enabled,perms:this.selectedPermsIds,menus:this.$refs.tree.getCheckedKeys()}).then(function(e){e&&200===e.data.code&&(t.$alert("角色更新成功！"),t.dialogFormVisible=!1,t.listRoles())})}}},a={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("el-dialog",{attrs:{title:"修改角色信息",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[l("el-form",{ref:"dataForm",staticStyle:{"text-align":"left"},model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}},[l("el-form-item",{attrs:{label:"角色名","label-width":"120px",prop:"username"}},[l("el-input",{attrs:{autocomplete:"off"},model:{value:e.selectedRole.name,callback:function(t){e.$set(e.selectedRole,"name",t)},expression:"selectedRole.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"角色描述","label-width":"120px",prop:"name"}},[l("el-input",{attrs:{autocomplete:"off"},model:{value:e.selectedRole.nameZh,callback:function(t){e.$set(e.selectedRole,"nameZh",t)},expression:"selectedRole.nameZh"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"功能配置","label-width":"120px",prop:"perms"}},[l("el-checkbox-group",{model:{value:e.selectedPermsIds,callback:function(t){e.selectedPermsIds=t},expression:"selectedPermsIds"}},e._l(e.perms,function(t,o){return l("el-checkbox",{key:o,attrs:{label:t.id}},[e._v(e._s(t.description))])}),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"菜单配置","label-width":"120px",prop:"menus"}},[l("el-tree",{ref:"tree",attrs:{data:e.menus,props:e.props,"show-checkbox":"","default-checked-keys":e.selectedMenusIds,"node-key":"id"}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit(e.selectedRole)}}},[e._v("确 定")])],1)],1),e._v(" "),l("el-row",{staticStyle:{margin:"18px 0px 0px 18px"}},[l("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[l("el-breadcrumb-item",{attrs:{to:{path:"/admin/dashboard"}}},[e._v("管理中心")]),e._v(" "),l("el-breadcrumb-item",[e._v("用户管理")]),e._v(" "),l("el-breadcrumb-item",[e._v("角色配置")])],1)],1),e._v(" "),l("role-create",{on:{onSubmit:function(t){return e.listRoles()}}}),e._v(" "),l("el-card",{staticStyle:{margin:"18px 2%",width:"95%"}},[l("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roles,stripe:"","max-height":e.tableHeight}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),l("el-table-column",{attrs:{prop:"id",label:"id",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"name",label:"角色名",fit:""}}),e._v(" "),l("el-table-column",{attrs:{prop:"nameZh",label:"角色描述",fit:""}}),e._v(" "),l("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(l){return e.commitStatusChange(l,t.row)}},model:{value:t.row.enabled,callback:function(l){e.$set(t.row,"enabled",l)},expression:"scope.row.enabled"}})]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(l){return e.editRole(t.row)}}},[e._v("\n            编辑\n          ")]),e._v(" "),l("el-button",{attrs:{type:"text",size:"small"}},[e._v("\n            移除\n          ")])]}}])})],1),e._v(" "),l("div",{staticStyle:{margin:"20px 0 20px 0",float:"left"}},[l("el-button",[e._v("取消选择")]),e._v(" "),l("el-button",[e._v("批量删除")])],1)],1)],1)},staticRenderFns:[]};var n=l("VU/8")(o,a,!1,function(e){l("AZ1j")},"data-v-b01b8fbc",null);t.default=n.exports}});
//# sourceMappingURL=6.569d54c769d86f06c6e2.js.map