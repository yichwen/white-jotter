webpackJsonp([7],{"0U9i":function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={name:"UserProfile",components:{BulkRegistration:l("VQCX").default},data:function(){return{users:[],roles:[],dialogFormVisible:!1,selectedUser:[],selectedRolesIds:[]}},mounted:function(){this.listUsers(),this.listRoles()},computed:{tableHeight:function(){return window.innerHeight-320}},methods:{listUsers:function(){var e=this;this.$axios.get("/admin/user").then(function(t){t&&200===t.data.code&&(e.users=t.data.result)})},listRoles:function(){var e=this;this.$axios.get("/admin/role").then(function(t){t&&200===t.data.code&&(e.roles=t.data.result)})},commitStatusChange:function(e,t){var l=this;"admin"!==t.username?this.$axios.put("/admin/user/status",{enabled:e,username:t.username}).then(function(o){o&&200===o.data.code&&(e?l.$message("用户 ["+t.username+"] 已启用"):l.$message("用户 ["+t.username+"] 已禁用"))}):(t.enabled=!0,this.$alert("不能禁用管理员账户"))},onSubmit:function(e){var t=this;this.$axios.put("/admin/user",{username:e.username,name:e.name,phone:e.phone,email:e.email,roles:this.selectedRolesIds}).then(function(e){e&&200===e.data.code?(t.$alert("用户信息修改成功"),t.dialogFormVisible=!1,t.listUsers()):t.$alert(e.data.message)})},editUser:function(e){this.dialogFormVisible=!0,this.selectedUser=e;for(var t=[],l=0;l<e.roles.length;l++)t.push(e.roles[l].id);this.selectedRolesIds=t},resetPassword:function(e){var t=this;this.$axios.put("/admin/user/password",{username:e}).then(function(e){e&&200===e.data.code&&t.$alert("密码已重置为 123")})}}},s={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("el-dialog",{attrs:{title:"修改用户信息",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[l("el-form",{ref:"dataForm",staticStyle:{"text-align":"left"},model:{value:e.selectedUser,callback:function(t){e.selectedUser=t},expression:"selectedUser"}},[l("el-form-item",{attrs:{label:"用户名","label-width":"120px",prop:"username"}},[l("label",[e._v(e._s(e.selectedUser.username))])]),e._v(" "),l("el-form-item",{attrs:{label:"真实姓名","label-width":"120px",prop:"name"}},[l("el-input",{attrs:{autocomplete:"off"},model:{value:e.selectedUser.name,callback:function(t){e.$set(e.selectedUser,"name",t)},expression:"selectedUser.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"手机号","label-width":"120px",prop:"phone"}},[l("el-input",{attrs:{autocomplete:"off"},model:{value:e.selectedUser.phone,callback:function(t){e.$set(e.selectedUser,"phone",t)},expression:"selectedUser.phone"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"邮箱","label-width":"120px",prop:"email"}},[l("el-input",{attrs:{autocomplete:"off"},model:{value:e.selectedUser.email,callback:function(t){e.$set(e.selectedUser,"email",t)},expression:"selectedUser.email"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"密码","label-width":"120px",prop:"password"}},[l("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.resetPassword(e.selectedUser.username)}}},[e._v("重置密码")])],1),e._v(" "),l("el-form-item",{attrs:{label:"角色分配","label-width":"120px",prop:"roles"}},[l("el-checkbox-group",{model:{value:e.selectedRolesIds,callback:function(t){e.selectedRolesIds=t},expression:"selectedRolesIds"}},e._l(e.roles,function(t,o){return l("el-checkbox",{key:o,attrs:{label:t.id}},[e._v(e._s(t.nameZh))])}),1)],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit(e.selectedUser)}}},[e._v("确 定")])],1)],1),e._v(" "),l("el-row",{staticStyle:{margin:"18px 0px 0px 18px"}},[l("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[l("el-breadcrumb-item",{attrs:{to:{path:"/admin/dashboard"}}},[e._v("管理中心")]),e._v(" "),l("el-breadcrumb-item",[e._v("用户管理")]),e._v(" "),l("el-breadcrumb-item",[e._v("用户信息")])],1)],1),e._v(" "),l("bulk-registration",{on:{onSubmit:function(t){return e.listUsers()}}}),e._v(" "),l("el-card",{staticStyle:{margin:"18px 2%",width:"95%"}},[l("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users,stripe:"","default-sort":{prop:"id",order:"ascending"},"max-height":e.tableHeight}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),l("el-table-column",{attrs:{prop:"id",label:"id",sortable:"",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"username",label:"用户名",fit:""}}),e._v(" "),l("el-table-column",{attrs:{prop:"name",label:"真实姓名",fit:""}}),e._v(" "),l("el-table-column",{attrs:{prop:"phone",label:"手机号",fit:""}}),e._v(" "),l("el-table-column",{attrs:{prop:"email",label:"邮箱","show-overflow-tooltip":"",fit:""}}),e._v(" "),l("el-table-column",{attrs:{label:"状态",sortable:"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(l){return e.commitStatusChange(l,t.row)}},model:{value:t.row.enabled,callback:function(l){e.$set(t.row,"enabled",l)},expression:"scope.row.enabled"}})]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text",size:"small"},on:{click:function(l){return e.editUser(t.row)}}},[e._v("编辑")]),e._v(" "),l("el-button",{attrs:{type:"text",size:"small"}},[e._v("移除")])]}}])})],1),e._v(" "),l("div",{staticStyle:{margin:"20px 0 20px 0",float:"left"}},[l("el-button",[e._v("取消选择")]),e._v(" "),l("el-button",[e._v("批量删除")])],1)],1)],1)},staticRenderFns:[]};var a=l("VU/8")(o,s,!1,function(e){l("PVo7")},"data-v-3d676a38",null);t.default=a.exports},"4BWg":function(e,t){},PVo7:function(e,t){},VQCX:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticStyle:{"text-align":"left"}},[l("el-button",{staticClass:"add-button",attrs:{type:"success"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("批量添加用户")]),e._v(" "),l("el-dialog",{attrs:{title:"添加用户",visible:e.dialogFormVisible,width:"25%"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.clear}},[l("el-form",{attrs:{model:e.loginForm,rules:e.rules,"label-position":"left","label-width":"0px"}},[l("el-form-item",{attrs:{prop:"username"}},[l("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"账号"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),l("el-form-item",{attrs:{prop:"password"}},[l("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),l("el-form-item",[l("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"真实姓名"},model:{value:e.loginForm.name,callback:function(t){e.$set(e.loginForm,"name",t)},expression:"loginForm.name"}})],1),e._v(" "),l("el-form-item",[l("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"电话号码"},model:{value:e.loginForm.phone,callback:function(t){e.$set(e.loginForm,"phone",t)},expression:"loginForm.phone"}})],1),e._v(" "),l("el-form-item",[l("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"E-Mail"},model:{value:e.loginForm.email,callback:function(t){e.$set(e.loginForm,"email",t)},expression:"loginForm.email"}})],1),e._v(" "),l("el-form-item",{staticStyle:{width:"100%"}},[l("el-button",{staticStyle:{width:"40%",background:"#505458",border:"none"},attrs:{type:"primary"},on:{click:e.register}},[e._v("添加")])],1)],1)],1)],1)},staticRenderFns:[]};var s=l("VU/8")({name:"BulkRegistration",data:function(){return{dialogFormVisible:!1,rules:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]},loginForm:{username:"",password:"",name:"",phone:"",email:""}}},methods:{clear:function(){this.loginForm={username:"",password:"",name:"",phone:"",email:""}},register:function(){var e=this;this.$axios.post("/register",{username:this.loginForm.username,password:this.loginForm.password,name:this.loginForm.name,phone:this.loginForm.phone,email:this.loginForm.email}).then(function(t){200===t.data.code?(e.$alert("注册成功","提示",{confirmButtonText:"确定"}),e.clear(),e.$emit("onSubmit")):e.$alert(t.data.message,"提示",{confirmButtonText:"确定"})}).catch(function(e){})}}},o,!1,function(e){l("4BWg")},"data-v-e6c1fe0e",null);t.default=s.exports}});
//# sourceMappingURL=7.e0b2ced23e38d1cfe51b.js.map