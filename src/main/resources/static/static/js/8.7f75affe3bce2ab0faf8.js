webpackJsonp([8],{"8zNu":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"BookManagement",components:{EditForm:o("EYD5").default},data:function(){return{books:[]}},mounted:function(){this.loadBooks()},computed:{tableHeight:function(){return window.innerHeight-320}},methods:{deleteBook:function(t){var e=this;this.$confirm("此操作将永久删除该书籍, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios.post("/admin/content/books/delete",{id:t}).then(function(t){t&&200===t.status&&e.loadBooks()})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},editBook:function(t){this.$refs.edit.dialogFormVisible=!0,this.$refs.edit.form={id:t.id,cover:t.cover,title:t.title,author:t.author,date:t.date,press:t.press,abs:t.abs,category:{id:t.category.id.toString(),name:t.category.name}}},loadBooks:function(){var t=this;this.$axios.get("/books").then(function(e){e&&200===e.status&&(t.books=e.data,console.log(t.books))})}}},l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-row",{staticStyle:{margin:"18px 0px 0px 18px"}},[o("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[o("el-breadcrumb-item",{attrs:{to:{path:"/admin/dashboard"}}},[t._v("管理中心")]),t._v(" "),o("el-breadcrumb-item",[t._v("内容管理")]),t._v(" "),o("el-breadcrumb-item",[t._v("图书管理")])],1)],1),t._v(" "),o("edit-form",{ref:"edit",on:{onSubmit:function(e){return t.loadBooks()}}}),t._v(" "),o("el-card",{staticStyle:{margin:"18px 2%",width:"95%"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.books,stripe:"","max-height":t.tableHeight}},[o("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),o("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-form",{attrs:{"label-position":"left",inline:""}},[o("el-form-item",[o("span",[t._v(t._s(e.row.abs))])])],1)]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"title",label:"书名（展开查看摘要）",fit:""}}),t._v(" "),o("el-table-column",{attrs:{prop:"category.name",label:"分类",width:"100"}}),t._v(" "),o("el-table-column",{attrs:{prop:"author",label:"作者",fit:""}}),t._v(" "),o("el-table-column",{attrs:{prop:"date",label:"出版日期",width:"120"}}),t._v(" "),o("el-table-column",{attrs:{prop:"press",label:"出版社",fit:""}}),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(o){return o.preventDefault(),t.editBook(e.row)}}},[t._v("\n            编辑\n          ")]),t._v(" "),o("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(o){return o.preventDefault(),t.deleteBook(e.row.id)}}},[t._v("\n            移除\n          ")])]}}])})],1),t._v(" "),o("div",{staticStyle:{margin:"20px 0 20px 0",float:"left"}},[o("el-button",[t._v("取消选择")]),t._v(" "),o("el-button",[t._v("批量删除")])],1)],1)],1)},staticRenderFns:[]};var r=o("VU/8")(a,l,!1,function(t){o("ayZW")},"data-v-2a86f81b",null);e.default=r.exports},EYD5:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"EditForm",components:{ImgUpload:o("1vuj").default},data:function(){return{dialogFormVisible:!1,form:{id:"",title:"",author:"",date:"",press:"",cover:"",abs:"",cid:"",category:{id:"",name:""}},formLabelWidth:"120px"}},methods:{clear:function(){this.$refs.imgUpload.clear(),this.form={id:"",title:"",author:"",date:"",press:"",cover:"",abs:"",category:{id:"",name:""}}},onSubmit:function(){var t=this;this.$axios.post("/admin/content/books",{id:this.form.id,cover:this.form.cover,title:this.form.title,author:this.form.author,date:this.form.date,press:this.form.press,abs:this.form.abs,category:this.form.category}).then(function(e){e&&200===e.status&&(t.dialogFormVisible=!1,t.$emit("onSubmit"))})},uploadImg:function(){this.form.cover=this.$refs.imgUpload.url}}},l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticStyle:{"text-align":"left"}},[o("el-button",{staticClass:"add-button",attrs:{type:"success"},on:{click:function(e){t.dialogFormVisible=!0}}},[t._v("添加图书")]),t._v(" "),o("el-dialog",{attrs:{title:"添加/修改图书",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.clear}},[o("el-form",{ref:"dataForm",staticStyle:{"text-align":"left"},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[o("el-form-item",{attrs:{label:"书名","label-width":t.formLabelWidth,prop:"title"}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"不加《》"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"作者","label-width":t.formLabelWidth,prop:"author"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.author,callback:function(e){t.$set(t.form,"author",e)},expression:"form.author"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"出版日期","label-width":t.formLabelWidth,prop:"date"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"出版社","label-width":t.formLabelWidth,prop:"press"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.press,callback:function(e){t.$set(t.form,"press",e)},expression:"form.press"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"封面","label-width":t.formLabelWidth,prop:"cover"}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"图片 URL"},model:{value:t.form.cover,callback:function(e){t.$set(t.form,"cover",e)},expression:"form.cover"}}),t._v(" "),o("img-upload",{ref:"imgUpload",on:{onUpload:t.uploadImg}})],1),t._v(" "),o("el-form-item",{attrs:{label:"简介","label-width":t.formLabelWidth,prop:"abs"}},[o("el-input",{attrs:{type:"textarea",autocomplete:"off"},model:{value:t.form.abs,callback:function(e){t.$set(t.form,"abs",e)},expression:"form.abs"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"分类","label-width":t.formLabelWidth,prop:"cid"}},[o("el-select",{attrs:{placeholder:"请选择分类"},model:{value:t.form.category.id,callback:function(e){t.$set(t.form.category,"id",e)},expression:"form.category.id"}},[o("el-option",{attrs:{label:"文学",value:"1"}}),t._v(" "),o("el-option",{attrs:{label:"流行",value:"2"}}),t._v(" "),o("el-option",{attrs:{label:"文化",value:"3"}}),t._v(" "),o("el-option",{attrs:{label:"生活",value:"4"}}),t._v(" "),o("el-option",{attrs:{label:"经管",value:"5"}}),t._v(" "),o("el-option",{attrs:{label:"科技",value:"6"}})],1)],1),t._v(" "),o("el-form-item",{staticStyle:{height:"0"},attrs:{prop:"id"}},[o("el-input",{attrs:{type:"hidden",autocomplete:"off"},model:{value:t.form.id,callback:function(e){t.$set(t.form,"id",e)},expression:"form.id"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=o("VU/8")(a,l,!1,function(t){o("WzDV")},"data-v-21f54acf",null);e.default=r.exports},WzDV:function(t,e){},ayZW:function(t,e){}});
//# sourceMappingURL=8.7f75affe3bce2ab0faf8.js.map